# ===================================
# RÈGLES SPÉCIFIQUES (PRIORITAIRES)
# ===================================
# Important : Les règles spécifiques doivent être AVANT les règles globales

[[redirects]]
  from = "/reports/uxco_ecla/*"
  to = "/.netlify/functions/verify-auth"
  status = 200
  force = true
  conditions = {Role = ["!authenticated"]}

# ===================================
# RÈGLES POUR ECLA - VERSION MINUSCULES /analyse/ecla/
# ===================================

# Laisser passer les fichiers statiques d'ECLA (PRIORITÉ ABSOLUE)
[[redirects]]
  from = "/analyse/ecla/static/*"
  to = "/analyse/ECLA/static/:splat"
  status = 200
  force = true

# Laisser passer les données JSON d'ECLA (PRIORITÉ ABSOLUE)
[[redirects]]
  from = "/analyse/ecla/data/*"
  to = "/analyse/ECLA/data/:splat"
  status = 200
  force = true

# Laisser passer les assets d'ECLA
[[redirects]]
  from = "/analyse/ecla/assets/*"
  to = "/analyse/ECLA/assets/:splat"
  status = 200
  force = true

# Laisser passer manifest/favicons d'ECLA
[[redirects]]
  from = "/analyse/ecla/*.json"
  to = "/analyse/ECLA/:splat"
  status = 200

[[redirects]]
  from = "/analyse/ecla/*.png"
  to = "/analyse/ECLA/:splat"
  status = 200

[[redirects]]
  from = "/analyse/ecla/*.ico"
  to = "/analyse/ECLA/:splat"
  status = 200

# SPA fallback d'ECLA (version minuscules) - TOUTES les routes vont sur index.html
[[redirects]]
  from = "/analyse/ecla/*"
  to = "/analyse/ECLA/index.html"
  status = 200

[[redirects]]
  from = "/analyse/ecla"
  to = "/analyse/ECLA/index.html"
  status = 200

# ===================================
# RÈGLES POUR UXCO - VERSION MINUSCULES /analyse/uxco/
# ===================================

# Laisser passer les fichiers statiques d'UXCO (PRIORITÉ ABSOLUE)
[[redirects]]
  from = "/analyse/uxco/static/*"
  to = "/analyse/UXCO/static/:splat"
  status = 200
  force = true

# Laisser passer les données JSON d'UXCO (PRIORITÉ ABSOLUE)
[[redirects]]
  from = "/analyse/uxco/data/*"
  to = "/analyse/UXCO/data/:splat"
  status = 200
  force = true

# Laisser passer les assets d'UXCO
[[redirects]]
  from = "/analyse/uxco/assets/*"
  to = "/analyse/UXCO/assets/:splat"
  status = 200
  force = true

# Laisser passer manifest/favicons d'UXCO
[[redirects]]
  from = "/analyse/uxco/*.json"
  to = "/analyse/UXCO/:splat"
  status = 200

[[redirects]]
  from = "/analyse/uxco/*.png"
  to = "/analyse/UXCO/:splat"
  status = 200

[[redirects]]
  from = "/analyse/uxco/*.ico"
  to = "/analyse/UXCO/:splat"
  status = 200

# SPA fallback d'UXCO (version minuscules) - TOUTES les routes vont sur index.html
[[redirects]]
  from = "/analyse/uxco/*"
  to = "/analyse/UXCO/index.html"
  status = 200

[[redirects]]
  from = "/analyse/uxco"
  to = "/analyse/UXCO/index.html"
  status = 200

# ===================================
# RÈGLES POUR UXCO - VERSION MAJUSCULES /analyse/UXCO/
# ===================================

# Laisser passer les fichiers statiques d'UXCO (PRIORITÉ ABSOLUE)
[[redirects]]
  from = "/analyse/UXCO/static/*"
  to = "/analyse/UXCO/static/:splat"
  status = 200
  force = true

# Laisser passer les données JSON d'UXCO (PRIORITÉ ABSOLUE)
[[redirects]]
  from = "/analyse/UXCO/data/*"
  to = "/analyse/UXCO/data/:splat"
  status = 200
  force = true

# Laisser passer les assets d'UXCO
[[redirects]]
  from = "/analyse/UXCO/assets/*"
  to = "/analyse/UXCO/assets/:splat"
  status = 200
  force = true

# Laisser passer manifest/favicons d'UXCO
[[redirects]]
  from = "/analyse/UXCO/*.json"
  to = "/analyse/UXCO/:splat"
  status = 200

[[redirects]]
  from = "/analyse/UXCO/*.png"
  to = "/analyse/UXCO/:splat"
  status = 200

[[redirects]]
  from = "/analyse/UXCO/*.ico"
  to = "/analyse/UXCO/:splat"
  status = 200

# SPA fallback d'UXCO - TOUTES les routes vont sur index.html
[[redirects]]
  from = "/analyse/UXCO/*"
  to = "/analyse/UXCO/index.html"
  status = 200

[[redirects]]
  from = "/analyse/UXCO"
  to = "/analyse/UXCO/index.html"
  status = 200

# ===================================
# RÈGLES POUR ECLA - VERSION MAJUSCULES /analyse/ECLA/
# ===================================

# Laisser passer les fichiers statiques d'ECLA (PRIORITÉ ABSOLUE)
[[redirects]]
  from = "/analyse/ECLA/static/*"
  to = "/analyse/ECLA/static/:splat"
  status = 200
  force = true

# Laisser passer les données JSON d'ECLA (PRIORITÉ ABSOLUE)
[[redirects]]
  from = "/analyse/ECLA/data/*"
  to = "/analyse/ECLA/data/:splat"
  status = 200
  force = true

# Laisser passer les assets d'ECLA
[[redirects]]
  from = "/analyse/ECLA/assets/*"
  to = "/analyse/ECLA/assets/:splat"
  status = 200
  force = true

# Laisser passer manifest/favicons d'ECLA
[[redirects]]
  from = "/analyse/ECLA/*.json"
  to = "/analyse/ECLA/:splat"
  status = 200

[[redirects]]
  from = "/analyse/ECLA/*.png"
  to = "/analyse/ECLA/:splat"
  status = 200

[[redirects]]
  from = "/analyse/ECLA/*.ico"
  to = "/analyse/ECLA/:splat"
  status = 200

# SPA fallback d'ECLA - TOUTES les routes vont sur index.html
[[redirects]]
  from = "/analyse/ECLA/*"
  to = "/analyse/ECLA/index.html"
  status = 200

[[redirects]]
  from = "/analyse/ECLA"
  to = "/analyse/ECLA/index.html"
  status = 200

# ===================================
# RÈGLES GLOBALES (EN DERNIER !)
# ===================================

# Rapports protégés
[[redirects]]
  from = "/reports/*"
  to = "/.netlify/functions/verify-auth"
  status = 200
  force = true
  conditions = {Role = ["!authenticated"]}

# Fallback global de la plateforme principale (login etc.)
# Cette règle doit être EN DERNIER
[[redirects]]
  from = "/*"
  to = "/index.html"
  status = 200

[functions]
  directory = "functions"
